// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
    output   = "../generated/prisma"
}

datasource db {
    provider = "sqlite"
    url      = "file:./dev.db"
}

enum UserType {
    CONTRACTOR
    HOMEOWNER
}

model User {
    id       Int      @id @default(autoincrement())
    username String   @unique
    name     String
    type     UserType

    createdAt DateTime @default(now())
    updatedAt DateTime @default(now()) @updatedAt

    jobsAsHomeowner Job[] @relation("JobHomeowners")
    jobsCreated     Job[] @relation("JobCreatedBy")
    jobsDeleted     Job[] @relation("JobDeletedBy")
}

enum JobStatus {
    PLANNING
    IN_PROGRESS
    COMPLETED
    CANCELED
}

model Job {
    id          Int       @id @default(autoincrement())
    description String
    location    String
    status      JobStatus
    cost        Float

    createdAt DateTime @default(now())
    updatedAt DateTime @default(now()) @updatedAt

    createdByUserId Int
    createdBy       User @relation("JobCreatedBy", fields: [createdByUserId], references: [id])

    homeowners User[] @relation("JobHomeowners")

    deletedAt       DateTime?
    deletedByUserId Int?
    deletedBy       User?     @relation("JobDeletedBy", fields: [deletedByUserId], references: [id])
}
